--- crypto/engine/eng_list.orig.c	2017-02-16 14:58:21.000000000 +0300
+++ crypto/engine/eng_list.c	2017-04-03 09:16:00.801555459 +0300
@@ -323,7 +323,11 @@
      */
     if (strcmp(id, "dynamic")) {
         if ((load_dir = getenv("OPENSSL_ENGINES")) == 0)
+        {
+#ifdef ENGINESDIR
             load_dir = ENGINESDIR;
+#endif
+        }
         iterator = ENGINE_by_id("dynamic");
         if (!iterator || !ENGINE_ctrl_cmd_string(iterator, "ID", id, 0) ||
             !ENGINE_ctrl_cmd_string(iterator, "DIR_LOAD", "2", 0) ||
